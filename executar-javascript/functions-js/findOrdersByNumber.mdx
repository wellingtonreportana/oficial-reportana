---
title: "findOrdersByNumber"
description: ""
---

## Introdu√ß√£o

A fun√ß√£o `findOrdersByNumber` permite localizar um pedido espec√≠fico atrav√©s do n√∫mero do pedido. Quando executada no bloco **Executar JavaScript**, ela verifica a exist√™ncia do pedido com base no n√∫mero do pedido informado pelo cliente e, se encontrado, retorna como resposta um array com detalhes completos sobre o pedido em quest√£o.

## Como utilizar

1. Primeiramente ser√° necess√°rio utilizar as configura√ß√µes avan√ßadas das nossas mensagens de WhatsApp para solicitar ao cliente o n√∫mero do pedido, salvando a resposta informada pelo cliente em uma vari√°vel, que nesse caso ser√° `payload.number`.

   <img
     src="/findOrdersByNumber-img1.png"
     alt="Resultado do Filtro `findOrdersByNumber`"
   />
   <img
     src="/findOrdersByNumber-img2.png"
     alt="Resultado do Filtro `findOrdersByNumber`"
   />

**Observa√ß√£o:** Para conhecer mais sobre as configura√ß√µes avan√ßadas das nossas mensagens de WhatsApp, acesse nosso artigo na central de ajuda: [Central de Ajuda - Entendendo as A√ß√µes de L√≥gico, Tempo, Chat e Avan√ßado das Automa√ß√µes.](https://reportana.com/help/article/conhecendo-opcoes-de-acao-tempo-e-logica-de-automacoes)

2. Em seguida, assim que o cliente informar o n√∫mero do pedido, na estrutura da automa√ß√£o, utilizaremos o bloco **Executar JavaScript** para executar a fun√ß√£o `findOrdersByNumber` e realizar a busca do pedido associado ao n√∫mero do pedido informado.

   <img
     src="/findOrdersByNumber-img3.png"
     alt="Resultado do Filtro `findOrdersByNumber`"
   />

3. No **Executar JavaScript** utilizamos o c√≥digo `payload.orders = await findOrdersByNumber(payload.number)` para buscar o pedido associado ao n√∫mero do informado pelo cliente. Dessa forma, o n√∫mero do pedido salvo na vari√°vel `payload.number` √© utilizado pela fun√ß√£o `findOrdersByNumber` para buscar o pedido associado a esse n√∫mero de pedido, o resultado √© armazenado em payload.orders, em forma de array contendo o pedido em quest√£o.

<img
  src="/findOrdersByNumber-img4.png"
  alt="Resultado do Filtro `findOrdersByNumber`"
/>

4. A resposta da busca poder√° retornar, nas pr√≥ximas mensagens, informa√ß√µes sobre o pedido encontrado.

   <img
     src="/findOrdersByNumber-img5.png"
     alt="Resultado do Filtro `findOrdersByNumber`"
   />
   <img
     src="/findOrdersByEmail-img6.png"
     alt="Resultado do Filtro `findOrdersByNumber`"
   />

<Accordion title="C√≥digo utilizado no exemplo">

```twig
{% if payload.orders is not empty %}
Encontramos *{{ payload.orders|length }}* pedido(s). Segue as informa√ß√µes:

{% for data in payload.orders %}
*#{{ data.order.number }}*
{% if data.order.payment_method == 'BOLETO' %}üè∑ _Boleto_{% elseif data.order.payment_method == 'CREDIT_CARD' %}üí≥ _Cart√£o de cr√©dito_{% elseif data.order.payment_method == 'PIX' %}ü§≥üèº _Pix_{% else %}üè∑ _Outro_{% endif %}

{% if data.order.payment_status == 'PAID' %}‚úÖ _Pago_{% elseif data.order.payment_status == 'PENDING' %}‚è≥ _Pendente_{% else %}‚ùå _N√£o pago_{% endif %}

{% if data.order.tracking_numbers_url is not empty %}üöö {{ data.order.tracking_numbers_url }}{% else %}üöö _Envio pendente_{% endif %}


{% endfor %}
{% else %}
Nenhum pedido encontrado.
{% endif %}
```

</Accordion>

**Observa√ß√£o:** No c√≥digo exemplo, caso n√£o seja encontrado nenhum pedido associado ao n√∫mero do pedido informado, a mensagem _"Nenhum pedido encontrado ser√° exibida"_.

Para estruturar a mensagem de resposta contendo os dados do pedido nesse exemplo, utilizamos a linguagem de template **Reportana¬Æ Script**, que permite o uso das estruturas `for` e `if/else`. Esses comandos possibilitam a formata√ß√£o detalhada e condicional das informa√ß√µes exibidas. Para aprofundar o conhecimento sobre o uso da **Reportana¬Æ Script** e explorar mais exemplos, consulte a documenta√ß√£o completa: [Reportana¬Æ Script - Documenta√ß√£o](https://reportana.mintlify.app/start/reportana-script).

## Retorno da fun√ß√£o `findOrdersByNumber`

```twig
{
  "orders": [
    {
      "reference_id": 1234,
      "reference_type": "ORDER",
      "customer_id": 1234,
      "name": "Jo√£o Teste",
      "first_name": "Jo√£o",
      "last_name": "Teste",
      "email": "teste@gmail.com",
      "phone": "55999999999",
      "shop": {
        "id": 1234,
        "name": "Loja Teste",
        "currency_code": "BRL",
        "billing_address_formatted": "Rua Florian√≥polis 123, Centro, S√£o Jos√©, MG, 36490-008, BR"
      },
      "customer": {
        "id": 104657184,
        "name": "Jo√£o Teste",
        "email": "teste@gmail.com",
        "phone": "55999999999",
        "birth_date": null,
        "metadata": []
      },
      "order": {
        "admin_url": "https://‚Ä¶.png",
        "customer_name": "Jo√£o Teste",
        "customer_email": "teste@gmail.com",
        "customer_phone": "55999999999",
        "customer_document": "12345678900",
        "billing_address": {
          "name": "Jo√£o Teste",
          "first_name": "Jo√£o",
          "last_name": "Teste",
          "company": null,
          "phone": "55999999999",
          "address1": "Rua Flores 456, Apto 31",
          "address2": "Centro",
          "city": "Florian√≥polis",
          "province": "Santa Catarina",
          "province_code": "SC",
          "country": "Brazil",
          "country_code": "BR",
          "zip": "06970000",
          "latitude": null,
          "longitude": null
        },
        "shipping_address": {
          "name": "Jo√£o Teste",
          "first_name": "Jo√£o",
          "last_name": "Teste",
          "company": null,
          "phone": "55999999999",
          "address1": "Rua Flores 456, Apto 31",
          "address2": "Centro",
          "city": "Florian√≥polis",
          "province": "Santa Catarina",
          "province_code": "SC",
          "country": "Brazil",
          "country_code": "BR",
          "zip": "06970000",
          "latitude": null,
          "longitude": null
        },
        "number": "1234",
        "currency": "BRL",
        "total_price": "99.90",
        "total_price_formatted": "R$99,90",
        "subtotal_price": "0.00",
        "subtotal_price_formatted": "R$0,00",
        "line_items": [
          {
            "title": "Meu Rob√¥",
            "variant_title": "Azul",
            "quantity": 1,
            "price": 210.27,
            "path": "https://‚Ä¶.png",
            "image_url": "https://‚Ä¶.png",
            "tracking_number": null
          }
        ],
        "payment_status": "PAID",
        "payment_method": "BOLETO",
        "billet_url": "https://boleto.pl/1234abcd",
        "billet_line": "00000000000000000000000000000000000000000000000",
        "billet_expired_at": "2024-04-30 00:00:00",
        "billet_expired_at_formatted": "30/04/2024",
        "original_created_at": "2024-04-27 08:30:06",
        "billing_address_formatted": "Rua Flores 456, Apto 31, Centro, Florian√≥polis, SC, 06970000",
        "shipping_address_formatted": "Rua Flores 456, Apto 31, Centro, Florian√≥polis, SC, 06970000",
        "line_items_formatted": "Meu Rob√¥",
        "line_items_formatted_with_variant": "Meu Rob√¥ - Azul",
        "tracking_numbers_formatted": "1234ABCD",
        "tracking_numbers_url": "https://boleto.pl/1234ABCD",
        "tracking_numbers": [
          {
            "code": "NL0000000000BR",
            "new_code": "NL0000000123BR",
            "full_status": "DELIVERED",
            "elapsed_time": 30,
            "tax_at": "2024-11-30 11:46:45",
            "delivered_at": "2024-12-14 11:46:45",
            "returning_to_sender_at": "2024-11-30 11:46:45",
            "returned_to_sender_at": "2024-11-30 11:46:45",
            "first_update_at": "2024-11-14 11:46:45",
            "last_update_at": "2024-12-14 11:46:45",
            "last_request_at": "2024-12-14 11:46:45",
            "events": [
              {
                "type": "CORREIOS",
                "date": "2024-12-14 11:46:45",
                "label": "Entregue",
                "location": "S√£o Paulo - SP",
                "description": "Sua encomenda foi entregue"
              },
              {
                "type": "CORREIOS",
                "date": "2024-11-14 11:46:45",
                "label": "Postado",
                "location": "S√£o Paulo - SP",
                "description": "Aceito pela transportadora"
              }
            ]
          }
        ]
      }
    }
  ]
}
```

## Dados retornados na resposta

A busca retorna diversas informa√ß√µes detalhadas sobre os pedidos, incluindo:

- **Dados do Cliente:** Nome, telefone, e-mail utilizados para realizar o pedido, etc;
- **Informa√ß√µes do Pedido:** ID do pedido, status de pagamento (ex.: pago, pendente), m√©todo de pagamento (ex.: boleto, cart√£o), data de cria√ß√£o do pedido, etc;
- **Dados de Endere√ßo:** Endere√ßo de cobran√ßa e endere√ßo de entrega, incluindo cidade, estado, CEP, etc;
- **Itens do Pedido:** Nome do produto, variante (ex.: cor), quantidade, pre√ßo unit√°rio, link para imagem do produto, etc;
- **Informa√ß√µes de Pagamento:** URL do boleto, linha digit√°vel do boleto, data de vencimento, Pix c√≥pia e cola, valor total do pedido, etc;
- **URLs √öteis:** Link para rastreamento do pedido e qualquer outras URLs relevantes.

Esses dados permitem compor mensagens personalizadas para informar o cliente sobre os detalhes dos pedidos associado ao n√∫mero do pedido informado na busca.
